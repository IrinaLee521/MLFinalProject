<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Predicting Operating System through Network Traffic &mdash; ML Final Project  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="CMSC 25422 Final Project" href="../index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> ML Final Project
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Predicting Operating System through Network Traffic</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Irina-Lee-&amp;-William-Wang">Irina Lee &amp; William Wang</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Loading-the-Data">Loading the Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Labelling-Our-Samples">Labelling Our Samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Training-Our-Classifiers">Training Our Classifiers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Random-Forest-Classifier">Random Forest Classifier</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ExtraTrees-Classifier">ExtraTrees Classifier</a></li>
<li class="toctree-l3"><a class="reference internal" href="#KNeighbors-Classifier">KNeighbors Classifier</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Understanding-the-model">Understanding the model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Conclusion">Conclusion</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ML Final Project</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a></li>
      <li class="breadcrumb-item active">Predicting Operating System through Network Traffic</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/notebooks/nprint-ml-tutorial.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars and line breaks on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
    white-space: pre;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="Predicting-Operating-System-through-Network-Traffic">
<h1>Predicting Operating System through Network Traffic<a class="headerlink" href="#Predicting-Operating-System-through-Network-Traffic" title="Permalink to this heading"></a></h1>
<section id="Irina-Lee-&amp;-William-Wang">
<h2>Irina Lee &amp; William Wang<a class="headerlink" href="#Irina-Lee-&-William-Wang" title="Permalink to this heading"></a></h2>
<p>This notebook represents our work for the final project in Machine Learning for Computer Systems. We took network data and labelled each flow with its corresponding operating system (according to CIC-IDS2017), then experimented with different models to see which one produced the best prediction results. The goal of this project was to replicate the best-known results produced by nPrint for the problem of OS Detection. We used Random Forest Classifiers, Extra Tree Classifiers, and K Nearest
Neighbors. Overall, we found that Random Forest Classifier produced the best resuls with an AUC score of 0.94.</p>
</section>
<section id="Loading-the-Data">
<h2>Loading the Data<a class="headerlink" href="#Loading-the-Data" title="Permalink to this heading"></a></h2>
<p>We used the Intrusion Detection Evaluation Dataset (CIC-IDS2017) from this website (<a class="reference external" href="https://www.unb.ca/cic/datasets/ids-2017.html">https://www.unb.ca/cic/datasets/ids-2017.html</a>) to get our data. We used flow data from the dataset labelled “Friday Morning Working Hours”.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">friday</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;TrafficLabelling/Friday-WorkingHours-Morning.pcap_ISCX.csv.gz&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of Packets: </span><span class="si">{0}</span><span class="s1">, Features per packet&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">friday</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">friday</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<p>We then print out the <code class="docutils literal notranslate"><span class="pre">friday</span></code> dataframe to observe the columns.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">friday</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Source IP</th>
      <th>Source Port</th>
      <th>Destination IP</th>
      <th>Destination Port</th>
      <th>Protocol</th>
      <th>Timestamp</th>
      <th>Flow Duration</th>
      <th>Total Fwd Packets</th>
      <th>Total Backward Packets</th>
      <th>Total Length of Fwd Packets</th>
      <th>...</th>
      <th>min_seg_size_forward</th>
      <th>Active Mean</th>
      <th>Active Std</th>
      <th>Active Max</th>
      <th>Active Min</th>
      <th>Idle Mean</th>
      <th>Idle Std</th>
      <th>Idle Max</th>
      <th>Idle Min</th>
      <th>Label</th>
    </tr>
    <tr>
      <th>Flow ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>192.168.10.3-192.168.10.50-3268-56108-6</th>
      <td>192.168.10.50</td>
      <td>56108</td>
      <td>192.168.10.3</td>
      <td>3268</td>
      <td>6</td>
      <td>7/7/2017 8:59</td>
      <td>112740690</td>
      <td>32</td>
      <td>16</td>
      <td>6448</td>
      <td>...</td>
      <td>32</td>
      <td>3.594286e+02</td>
      <td>1.199802e+01</td>
      <td>380.0</td>
      <td>343.0</td>
      <td>16100000.0</td>
      <td>4.988048e+05</td>
      <td>16400000.0</td>
      <td>15400000.0</td>
      <td>BENIGN</td>
    </tr>
    <tr>
      <th>192.168.10.3-192.168.10.50-389-42144-6</th>
      <td>192.168.10.50</td>
      <td>42144</td>
      <td>192.168.10.3</td>
      <td>389</td>
      <td>6</td>
      <td>7/7/2017 8:59</td>
      <td>112740560</td>
      <td>32</td>
      <td>16</td>
      <td>6448</td>
      <td>...</td>
      <td>32</td>
      <td>3.202857e+02</td>
      <td>1.574499e+01</td>
      <td>330.0</td>
      <td>285.0</td>
      <td>16100000.0</td>
      <td>4.987937e+05</td>
      <td>16400000.0</td>
      <td>15400000.0</td>
      <td>BENIGN</td>
    </tr>
    <tr>
      <th>8.0.6.4-8.6.0.1-0-0-0</th>
      <td>8.6.0.1</td>
      <td>0</td>
      <td>8.0.6.4</td>
      <td>0</td>
      <td>0</td>
      <td>7/7/2017 9:00</td>
      <td>113757377</td>
      <td>545</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>9.361829e+06</td>
      <td>7.324646e+06</td>
      <td>18900000.0</td>
      <td>19.0</td>
      <td>12200000.0</td>
      <td>6.935824e+06</td>
      <td>20800000.0</td>
      <td>5504997.0</td>
      <td>BENIGN</td>
    </tr>
    <tr>
      <th>192.168.10.9-224.0.0.252-63210-5355-17</th>
      <td>192.168.10.9</td>
      <td>63210</td>
      <td>224.0.0.252</td>
      <td>5355</td>
      <td>17</td>
      <td>7/7/2017 9:00</td>
      <td>100126</td>
      <td>22</td>
      <td>0</td>
      <td>616</td>
      <td>...</td>
      <td>32</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000e+00</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>BENIGN</td>
    </tr>
    <tr>
      <th>192.168.10.9-224.0.0.22-0-0-0</th>
      <td>192.168.10.9</td>
      <td>0</td>
      <td>224.0.0.22</td>
      <td>0</td>
      <td>0</td>
      <td>7/7/2017 9:00</td>
      <td>54760</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000e+00</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>BENIGN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>192.168.10.3-192.168.10.14-53-51018-17</th>
      <td>192.168.10.14</td>
      <td>51018</td>
      <td>192.168.10.3</td>
      <td>53</td>
      <td>17</td>
      <td>7/7/2017 12:59</td>
      <td>61452</td>
      <td>4</td>
      <td>2</td>
      <td>180</td>
      <td>...</td>
      <td>20</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000e+00</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>BENIGN</td>
    </tr>
    <tr>
      <th>192.168.10.3-192.168.10.14-53-49984-17</th>
      <td>192.168.10.14</td>
      <td>49984</td>
      <td>192.168.10.3</td>
      <td>53</td>
      <td>17</td>
      <td>7/7/2017 12:59</td>
      <td>171</td>
      <td>2</td>
      <td>2</td>
      <td>80</td>
      <td>...</td>
      <td>32</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000e+00</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>BENIGN</td>
    </tr>
    <tr>
      <th>192.168.10.3-192.168.10.14-53-64015-17</th>
      <td>192.168.10.14</td>
      <td>64015</td>
      <td>192.168.10.3</td>
      <td>53</td>
      <td>17</td>
      <td>7/7/2017 12:59</td>
      <td>222</td>
      <td>2</td>
      <td>2</td>
      <td>90</td>
      <td>...</td>
      <td>32</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000e+00</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>BENIGN</td>
    </tr>
    <tr>
      <th>192.168.10.17-198.100.147.178-123-123-17</th>
      <td>192.168.10.17</td>
      <td>123</td>
      <td>198.100.147.178</td>
      <td>123</td>
      <td>17</td>
      <td>7/7/2017 12:59</td>
      <td>16842</td>
      <td>1</td>
      <td>1</td>
      <td>48</td>
      <td>...</td>
      <td>20</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000e+00</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>BENIGN</td>
    </tr>
    <tr>
      <th>192.168.10.3-192.168.10.5-53-59851-17</th>
      <td>192.168.10.5</td>
      <td>59851</td>
      <td>192.168.10.3</td>
      <td>53</td>
      <td>17</td>
      <td>7/7/2017 12:59</td>
      <td>153</td>
      <td>2</td>
      <td>2</td>
      <td>68</td>
      <td>...</td>
      <td>20</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000e+00</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>BENIGN</td>
    </tr>
  </tbody>
</table>
<p>191033 rows × 84 columns</p>
</div></div>
</div>
</section>
<section id="Labelling-Our-Samples">
<h2>Labelling Our Samples<a class="headerlink" href="#Labelling-Our-Samples" title="Permalink to this heading"></a></h2>
<p>We label each sample with its corresponding operating system by matching its source IP address to the OS found on this website <a class="reference external" href="https://www.unb.ca/cic/datasets/ids-2017.html">https://www.unb.ca/cic/datasets/ids-2017.html</a>. There were IP addresses in the dataset that did not have any corresponding OS, so we just labelled it with a default value of “Other.” Because OS was labelled using IP address, we dropped all columns that had a direct relationship with IP, including Source IP, Destination IP, and Destination Port. This also matched what the
nPrint researchers did in their study as well. Furthermore, we also dropped timestamp because logicaly timestamp and OS shouldn’t have much correlation, and we didn’t want any spurious correlations between time and OS prediction.</p>
<p>We also ran into some issues with our samples being float64 while the models could only accept float32, so we converted all float64 values into float32 types.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="n">samples</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">friday</span> <span class="o">=</span> <span class="n">friday</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
<span class="n">friday</span> <span class="o">=</span> <span class="n">friday</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="c1"># label the operating system based on IP address from this website: https://www.unb.ca/cic/datasets/ids-2017.html</span>
<span class="n">ip_to_os</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;205.174.165.73&#39;</span><span class="p">:</span> <span class="s1">&#39;Kali&#39;</span><span class="p">,</span> <span class="s1">&#39;205.174.165.69&#39;</span><span class="p">:</span> <span class="s1">&#39;Win&#39;</span><span class="p">,</span> <span class="s1">&#39;205.174.165.70&#39;</span><span class="p">:</span> <span class="s1">&#39;Win&#39;</span><span class="p">,</span> <span class="s1">&#39;205.174.165.71&#39;</span><span class="p">:</span> <span class="s1">&#39;Win&#39;</span><span class="p">,</span> <span class="s1">&#39;192.168.10.50&#39;</span><span class="p">:</span> <span class="s1">&#39;Web server 16 Public&#39;</span><span class="p">,</span> <span class="s1">&#39;192.168.10.205.174.165.68&#39;</span><span class="p">:</span> <span class="s1">&#39;Web server 16 Public&#39;</span><span class="p">,</span> <span class="s1">&#39;192.168.10.51&#39;</span><span class="p">:</span> <span class="s1">&#39;Ubuntu server 12 Public&#39;</span><span class="p">,</span> <span class="s1">&#39;192.168.10.205.174.165.66&#39;</span><span class="p">:</span> <span class="s1">&#39;Ubuntu server 12 Public&#39;</span><span class="p">,</span> <span class="s1">&#39;192.168.10.19&#39;</span><span class="p">:</span> <span class="s1">&#39;Ubuntu 14.4, 32B&#39;</span><span class="p">,</span> <span class="s1">&#39;192.168.10.17&#39;</span><span class="p">:</span> <span class="s1">&#39;Ubuntu 14.4, 64B&#39;</span><span class="p">,</span> <span class="s1">&#39;192.168.10.16&#39;</span><span class="p">:</span> <span class="s1">&#39;Ubuntu 16.4, 32B&#39;</span><span class="p">,</span> <span class="s1">&#39;192.168.10.12&#39;</span><span class="p">:</span> <span class="s1">&#39;Ubuntu 16.4, 64B&#39;</span><span class="p">,</span> <span class="s1">&#39;192.168.10.9&#39;</span><span class="p">:</span> <span class="s1">&#39;Win 7 Pro, 64B&#39;</span><span class="p">,</span> <span class="s1">&#39;192.168.10.5&#39;</span><span class="p">:</span> <span class="s1">&#39;Win 8.1, 64B&#39;</span><span class="p">,</span> <span class="s1">&#39;192.168.10.8&#39;</span><span class="p">:</span> <span class="s1">&#39;Win Vista, 64B&#39;</span><span class="p">,</span> <span class="s1">&#39;192.168.10.14&#39;</span><span class="p">:</span> <span class="s1">&#39;Win 10, pro 32B&#39;</span><span class="p">,</span> <span class="s1">&#39;192.168.10.15&#39;</span><span class="p">:</span> <span class="s1">&#39;Win 10, 64B&#39;</span><span class="p">,</span> <span class="s1">&#39;192.168.10.25&#39;</span><span class="p">:</span> <span class="s1">&#39;MAC&#39;</span><span class="p">}</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">friday</span><span class="p">[</span><span class="s1">&#39; Source IP&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="s2">&quot;Other&quot;</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ip_to_os</span> <span class="k">else</span> <span class="n">ip_to_os</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">friday</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39; Source IP&#39;</span><span class="p">,</span> <span class="s1">&#39; Source Port&#39;</span><span class="p">,</span> <span class="s1">&#39; Destination IP&#39;</span><span class="p">,</span> <span class="s1">&#39; Destination Port&#39;</span><span class="p">,</span> <span class="s1">&#39; Timestamp&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">samples</span><span class="o">.</span><span class="n">_get_numeric_data</span><span class="p">()</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">samples</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">samples</span> <span class="o">=</span> <span class="n">samples</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">samples</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
float32    78
dtype: int64
</pre></div></div>
</div>
</section>
<section id="Training-Our-Classifiers">
<h2>Training Our Classifiers<a class="headerlink" href="#Training-Our-Classifiers" title="Permalink to this heading"></a></h2>
<p>We now train our data on a multitude of different classifiers to identify the best-performing classifier for OS detection. We try Random Forest Classifier, ExtraTrees Classifier and K Nearest Neighbors Classifier. We found that Random Forest Classifier performed the best with an AUC score of 0.94 and K Nearest Neighbors performed the worst with an AUC score of 0.81.</p>
<section id="Random-Forest-Classifier">
<h3>Random Forest Classifier<a class="headerlink" href="#Random-Forest-Classifier" title="Permalink to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">classification_report</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">roc_auc_score</span>

<span class="c1"># Split data</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>

<span class="c1"># Initialize Classifier</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">min_samples_split</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Train</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Predict</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Statistics</span>

<span class="c1"># First, lets get a stat report about the precision and recall:</span>
<span class="n">report</span> <span class="o">=</span> <span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">report</span><span class="p">)</span>

<span class="c1"># Let&#39;s also get the ROC AUC score while we&#39;re here, which requires a probability instead of just the prediction</span>
<span class="n">y_pred_proba</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="c1"># predict_proba gives us a probability estimate of each class, while roc_auc just cares about the &quot;positive&quot; class</span>
<span class="n">y_pred_proba_pos</span> <span class="o">=</span> <span class="p">[</span><span class="n">sublist</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">y_pred_proba</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                         precision    recall  f1-score   support

                   Kali       0.92      0.92      0.92       161
                    MAC       0.87      0.80      0.84      1695
                  Other       0.98      0.99      0.98     13838
       Ubuntu 14.4, 32B       0.58      0.61      0.60      3809
       Ubuntu 14.4, 64B       0.47      0.39      0.42      2468
       Ubuntu 16.4, 32B       0.50      0.40      0.44      2486
       Ubuntu 16.4, 64B       0.53      0.62      0.57      4381
Ubuntu server 12 Public       0.97      0.91      0.94       247
   Web server 16 Public       0.83      0.88      0.86      1007
            Win 10, 64B       0.48      0.47      0.47      3305
        Win 10, pro 32B       0.44      0.35      0.39      2590
         Win 7 Pro, 64B       0.50      0.55      0.53      4407
           Win 8.1, 64B       0.55      0.59      0.57      4783
         Win Vista, 64B       0.51      0.49      0.50      2551

               accuracy                           0.67     47728
              macro avg       0.65      0.64      0.64     47728
           weighted avg       0.67      0.67      0.67     47728

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">roc</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_proba</span><span class="p">,</span> <span class="n">multi_class</span><span class="o">=</span><span class="s2">&quot;ovo&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ROC AUC Score: </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">roc</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
ROC AUC Score: 0.9480181246701394
</pre></div></div>
</div>
</section>
<section id="ExtraTrees-Classifier">
<h3>ExtraTrees Classifier<a class="headerlink" href="#ExtraTrees-Classifier" title="Permalink to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">ExtraTreesClassifier</span>

<span class="c1"># Split data</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>

<span class="c1"># Initialize Classifier</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">ExtraTreesClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">min_samples_split</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Train</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Predict</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Statistics</span>

<span class="c1"># First, lets get a stat report about the precision and recall:</span>
<span class="n">report</span> <span class="o">=</span> <span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">report</span><span class="p">)</span>

<span class="c1"># Let&#39;s also get the ROC AUC score while we&#39;re here, which requires a  probability instead of just the prediction</span>
<span class="n">y_pred_proba</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="c1"># predict_proba gives us a probability estimate of each class, while roc_auc just cares about the &quot;positive&quot; class</span>
<span class="n">y_pred_proba_pos</span> <span class="o">=</span> <span class="p">[</span><span class="n">sublist</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">y_pred_proba</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                         precision    recall  f1-score   support

                   Kali       0.90      0.91      0.90       184
                    MAC       0.86      0.84      0.85      1723
                  Other       0.98      0.98      0.98     13974
       Ubuntu 14.4, 32B       0.58      0.60      0.59      3730
       Ubuntu 14.4, 64B       0.44      0.40      0.42      2477
       Ubuntu 16.4, 32B       0.47      0.41      0.44      2426
       Ubuntu 16.4, 64B       0.55      0.62      0.58      4355
Ubuntu server 12 Public       0.93      0.94      0.94       266
   Web server 16 Public       0.86      0.86      0.86       984
            Win 10, 64B       0.45      0.45      0.45      3165
        Win 10, pro 32B       0.38      0.33      0.35      2622
         Win 7 Pro, 64B       0.49      0.52      0.51      4403
           Win 8.1, 64B       0.54      0.57      0.55      4822
         Win Vista, 64B       0.52      0.47      0.49      2597

               accuracy                           0.67     47728
              macro avg       0.64      0.64      0.64     47728
           weighted avg       0.67      0.67      0.67     47728

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">roc</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_proba</span><span class="p">,</span> <span class="n">multi_class</span><span class="o">=</span><span class="s2">&quot;ovo&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ROC AUC Score: </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">roc</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
ROC AUC Score: 0.9304106731453283
</pre></div></div>
</div>
</section>
<section id="KNeighbors-Classifier">
<h3>KNeighbors Classifier<a class="headerlink" href="#KNeighbors-Classifier" title="Permalink to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>

<span class="c1"># Split data</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>

<span class="c1"># Initialize Classifier</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">()</span>

<span class="c1"># Train</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Predict</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Statistics</span>

<span class="c1"># First, lets get a stat report about the precision and recall:</span>
<span class="n">report</span> <span class="o">=</span> <span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">report</span><span class="p">)</span>

<span class="c1"># Let&#39;s also get the ROC AUC score while we&#39;re here, which requires a probability instead of just the prediction</span>
<span class="n">y_pred_proba</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="c1"># predict_proba gives us a probability estimate of each class, while roc_auc just cares about the &quot;positive&quot; class</span>
<span class="n">y_pred_proba_pos</span> <span class="o">=</span> <span class="p">[</span><span class="n">sublist</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">y_pred_proba</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                         precision    recall  f1-score   support

                   Kali       0.66      0.75      0.70       179
                    MAC       0.51      0.69      0.58      1660
                  Other       0.93      0.97      0.95     13996
       Ubuntu 14.4, 32B       0.33      0.47      0.38      3797
       Ubuntu 14.4, 64B       0.25      0.26      0.25      2361
       Ubuntu 16.4, 32B       0.28      0.25      0.26      2455
       Ubuntu 16.4, 64B       0.36      0.34      0.35      4328
Ubuntu server 12 Public       0.76      0.68      0.72       255
   Web server 16 Public       0.75      0.73      0.74      1015
            Win 10, 64B       0.30      0.30      0.30      3273
        Win 10, pro 32B       0.28      0.22      0.24      2599
         Win 7 Pro, 64B       0.36      0.35      0.35      4326
           Win 8.1, 64B       0.45      0.38      0.42      4886
         Win Vista, 64B       0.38      0.24      0.29      2598

               accuracy                           0.54     47728
              macro avg       0.47      0.47      0.47     47728
           weighted avg       0.53      0.54      0.53     47728

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">roc</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_proba</span><span class="p">,</span> <span class="n">multi_class</span><span class="o">=</span><span class="s2">&quot;ovo&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ROC AUC Score: </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">roc</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
ROC AUC Score: 0.814932109085949
</pre></div></div>
</div>
</section>
</section>
<section id="Understanding-the-model">
<h2>Understanding the model<a class="headerlink" href="#Understanding-the-model" title="Permalink to this heading"></a></h2>
<p>We use the classifiers’ built-in <code class="docutils literal notranslate"><span class="pre">feature_importances_</span></code> field to check which features are most important in OS detection. We see that Bakcward Average Bulk Rate stands out as the most important feature in predicting operating system, with Backward PSH Flags, and Backward Packet Length also contributing.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get Raw feature importances</span>
<span class="n">feature_importances</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">feature_importances_</span>
<span class="c1"># Match the feature names we know with the importances</span>
<span class="n">named_importances</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">column_name</span><span class="p">,</span> <span class="n">importance</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">friday</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">feature_importances</span><span class="p">):</span>
    <span class="n">named_importances</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">column_name</span><span class="p">,</span> <span class="n">importance</span><span class="p">))</span>
<span class="c1"># Sort the named feature importances</span>
<span class="n">sorted_feature_importances</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">named_importances</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">tup</span><span class="p">:</span> <span class="n">tup</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># Now lets print the top 20 important features (bits)</span>
<span class="nb">print</span><span class="p">(</span><span class="o">*</span><span class="n">sorted_feature_importances</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">20</span><span class="p">],</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(&#39;Bwd Avg Bulk Rate&#39;, 0.06587550618756476)
(&#39; Bwd PSH Flags&#39;, 0.03456268321739852)
(&#39; Bwd Packet Length Std&#39;, 0.03388788337733025)
(&#39;Bwd Packet Length Max&#39;, 0.03321528965970906)
(&#39; Source Port&#39;, 0.032348214504896076)
(&#39; Bwd Packet Length Min&#39;, 0.03103152576909429)
(&#39; Fwd Packet Length Std&#39;, 0.027906934094365753)
(&#39; Fwd URG Flags&#39;, 0.027673210505167998)
(&#39;Flow Bytes/s&#39;, 0.026854952635362212)
(&#39; Bwd Packet Length Mean&#39;, 0.023765668338893303)
(&#39; Destination Port&#39;, 0.02040653695907125)
(&#39; Flow IAT Max&#39;, 0.020325223913026234)
(&#39; Flow Packets/s&#39;, 0.01982427522386787)
(&#39; Bwd Avg Bytes/Bulk&#39;, 0.019470949545454263)
(&#39; Flow IAT Mean&#39;, 0.01926322793584967)
(&#39; Subflow Bwd Packets&#39;, 0.01912892502631372)
(&#39; Flow IAT Min&#39;, 0.01886823846283587)
(&#39;Fwd PSH Flags&#39;, 0.0180025710790003)
(&#39; Packet Length Variance&#39;, 0.01773255467280275)
(&#39; ACK Flag Count&#39;, 0.017037203867046335)
</pre></div></div>
</div>
</section>
<section id="Conclusion">
<h2>Conclusion<a class="headerlink" href="#Conclusion" title="Permalink to this heading"></a></h2>
<p>To c</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../index.html" class="btn btn-neutral float-left" title="CMSC 25422 Final Project" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Irina Lee, William Wang.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>